# Modelización de datos de geolocalización de especies arbóreas mediante redes complejas. 

Este repositorio forma parte del trabajo de fin de grado (biotecnología, itinerario computacional, UPM) de Lucía Almorox. Se compone de un conjunto de scripts que permite obtener información sobre las relaciones espaciales que se dan entre individuos y las relaciones de coexistencia que se dan entre especies de una población arbórea dada. Para ello se aplica la teoría de grafos a partir de un registro en el que cada árbol ha de tener detallados los siguientes atributos: identificador de árbol, longitud, latitud (coordenadas decimales) y especie. Cada script ofrece un tipo de información diferente, ya sea de análisis de propiedades o de representación gráfica o geográfica de las redes. 

* El script **Procesamiento_de_registros.r** permite obtener el registro necesario para la modelización a partir de un archivo .CSV de ocurrencias de [GBIF](https://www.gbif.org/). Para ello selecciona los atributos de interés y elimina ocurrencias repetidas.
* El script **Grafos_en_funcion_de_r.r** toma como entrada un registro y un conjunto de valores de distancia umbral. Para cada distinto valor de distancia umbral crea un grafo espacial de individuos (un enlace entre dos nodos indica que los dos árboles se encuentran a una distancia igual o menor que la distancia umbral)  y un grafo no espacial de especies (un enlace entre dos especies indica que hay al menos un par de individuos que, perteneciendo cada uno a una de las dos especies, se encuentran a una distancia igual o  menor que la distancia umbral). De cada grafo creado calcula todas las propiedades mencionadas. Así, permite el estudio del comportamiento de cada propiedad en función de la distancia umbral para cada tipo de red (de individuos y de especies). Este script está preparado para modelizar grandes poblaciones de árboles, mediante un proceso de parcelación del territorio para el cálculo eficiente de las distancia por pares (se ha probado su eficacia con más de un millón de árboles y seguramente funcione con más, aunque las limitaciones están en la capacidad del ordenador para crear mega-grafos y en la disponibilidad de registros más completos). En este caso, los parámetros por defecto están referidos al territorio andaluz.
* El script **Analisis_tp.r** toma como entrada un registro, una lista de adyacencia de un grafo de individuos (calculada sobre la población del registro bajo un valor de distancia umbral determinado, como las que produce el script anterior) y un conjunto de valores de $T_p$ (mínimo número de pares de individuos a una distancia igual o menor que la distancia umbral que han de existir entre dos especies para que estas se consideren adyacentes en el grafo de especies). Con cada valor de $T_p$ crea un grafo de especies y calcula todas sus propiedades para llevar a cabo un análisis de las mismas en función de este nuevo parámetro.
* El script **Creacion_archivos_QGIS.r** permite obtener archivos con información que pueda ser interpretada por un sowtware geográfico para su proyección cartográfica cenital. En concreto, permite, a partir de un registro y de una lista de adyacencia de un grafo espacial de individuos:
    - obtener un archivo que permita la representación de la red completa (nodos y enlaces) en [QGIS](https://www.qgis.org/es/site/), donde se puede superponer               la red sobre un mapa satélite.
    - calcular el camino mínimo entre dos nodos del grafo (elegidos por el usuario) y generar un archivo con la secuencia de cada nodo georreferenciado y con                 la información necesaria para que QGIS pueda representar el camino sobre el mapa. 
* El script **Representacion_grafo_especies_R.r** permite obtener diversa información sobre la importancia de cada nodo en el grafo o en su comunidad de Louvain. La "importancia" de un nodo se estudia en base a su grado (número de vecinos) o su centralidad (betweeness). Permite también la representación gráfica de esta red no espacial de manera que sea informativa sobre las comunidades de Louvain calculadas (se distinguen por colores).  

Todo el código está escrito en R y para la creación de grafos y el cálculo de sus propiedades se utiliza el paquete [igraph](https://igraph.org/r).
